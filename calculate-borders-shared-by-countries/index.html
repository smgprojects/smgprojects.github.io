<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Calculate Borders Shared by Countries</title>
    <meta name="description" content="The open history notebook of historian Jason A. Heppler.">
    <meta name="author" content="Jason A. Heppler"/>

    <!-- Get date last modified from git log. (Uses current time if file entry not found, e.g. projects/)  -->
    

    <!-- For posts, page.date is the date they are published under, which we use as their 'canonical' dc:date -->
    
      
      

    <!-- RDFa Metadata (in DublinCore) -->
    <meta property="dc:title" content="Calculate Borders Shared by Countries" />
    <meta property="dc:creator" content="Jason A. Heppler" />
    <meta property="dc:date" content="2016-02-03T17:25:00-05:00" />
    <meta property="dc:format" content="text/html" />
    <meta property="dc:language" content="en" />
    <meta property="dc:identifier" content="/calculate-borders-shared-by-countries/" />
    <meta property="dc:rights" content="CC BY-NC-SA 3.0" />
    <meta property="dc:source" content="Open History Notebook" />
    <meta property="dc:subject" content="History" />
    <meta property="dc:type" content="website" />

    <!-- RDFa Metadata (in OpenGraph) -->
    <meta property="og:title" content="Calculate Borders Shared by Countries" />
    <meta property="og:author" content="http://notebook.dev/bio.html" />
    <meta property="og:site_name" content="Open History Notebook" />
    <meta property="og:url" content="http://notebook.dev/calculate-borders-shared-by-countries/" />
    <meta property="og:type" content="website" />

    <!-- Google Scholar Metadata -->
    <meta name="citation_author" content="Jason A. Heppler"/>
    <meta name="citation_date" content="2016-02-03T17:25:00-05:00"/>
    <meta name="citation_title" content="Calculate Borders Shared by Countries"/>
    <meta name="citation_journal_title" content="Open History Notebook"/>

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="">
    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="http://notebook.dev">
    <meta name="twitter:title" content="Open History Notebook">
    <meta name="twitter:description" content="The open history notebook of historian Jason A. Heppler.">

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:100,400,400italic,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif' rel='stylesheet' type='text/css'>
    <script src="https://use.typekit.net/wak0qrc.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="http://notebook.dev/components/bootstrap/dist/css/bootstrap.min.css">
    <script type="text/javascript" src="http://notebook.dev/components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://notebook.dev/components/jquery/dist/jquery.min.js"></script>

    <!-- Custom Styling -->
    <link rel="stylesheet" href="http://notebook.dev/css/main.css">
    <!-- <link rel="stylesheet" href="http://notebook.dev/css/search.css"> -->
    <!-- <link rel="stylesheet" href="http://notebook.dev/css/custom.css"> -->
    <link rel="stylesheet" href="http://notebook.dev/css/bigfoot-default.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-3dkvEK0WLHRJ7/Csr0BZjAWxERc5WH7bdeUya2aXxdU= sha512-+L4yy6FRcDGbXJ9mPG8MT/3UCDzwR9gPeyFNMCtInsol++5m3bk2bXWKdZjvybmohrAsn3Ua5x8gfLnbE1YkOg==" crossorigin="anonymous">
    <link rel="canonical" href="http://notebook.jasonheppler.orghttp://notebook.dev/calculate-borders-shared-by-countries/">

    <!-- Initialize Bigfoot.js -->
    <script type="text/javascript" src="http://notebook.dev/components/bigfoot/bigfoot.js"></script>
    <script type="text/javascript">
        $.bigfoot();
    </script>

    <!-- Todo lists (via Lincoln Mullen) -->
    <script type="text/javascript">
      /* <![CDATA[ */
      $(document).ready(function() {
        $("li:contains('[ ]')").html(function(_, html) {
          return html.replace('[ ]', '<span style="color:red;">☐</span>');
        });
        $("li:contains('[s]')").html(function(_, html) {
          return html.replace('[s]', '<span style="color:gold;">☐</span>');
        });
        $("li:contains('[x]')").html(function(_, html) {
          return html.replace('[x]', '<span style="color:green;">☑</span>');
        });
      });
      /* ]]> */
    </script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://notebook.dev/">Open History Notebook</a>

    <nav class="site-nav">
      <ul>
        <li><a href="http://notebook.dev/about/">About</a></li>
        <li><a href="http://notebook.dev/essays/">Essays</a></li>
        <li><a href="/feed.xml">RSS</a></li>
      </ul>
    </nav>

  </div>

</header>


    <div class="page-content">
    <div class="container-fluid">
      <div class="row-fluid">
        <div class="span3">

  <div class="well sidebar-nav">

  <center><img src="http://notebook.dev/images/logo.png" class="img-responsive" alt="Jason Heppler's Notebook"/><br/>
  <a href="http://jasonheppler.org">Jason Heppler</a>
  </center>

  <br/>

  <div id="search">
    <form action="http://duckduckgo.com/" method="get">
    <input type="hidden" name="sites" value="notebook.jasonheppler.org" />
      <input type="text" id="search_input" name="q" placeholder="Search" autocomplete="off">
    </form>
  </div>

    <ul class="nav nav-list">
      <li class="nav-header">General</li>
      <li><a href="http://notebook.dev/tagged/">Notes by Tag</a></li>
      <li><a href="http://notebook.dev/archive/">All Notes by Date</a></li>
      <li><a href="http://notebook.dev/archive-alphabetical/">All Notes Alphabetically</a></li>
      <li><a href="http://notebook.dev/essays/">Essays and General Writing</a></li>
      <li><a href="http://notebook.dev/categories/">Categories</a></li>

      <li class="nav-header">Topics and Projects</li>
      <li><a href="http://notebook.dev/reading-notes/">Reading Notes</a></li>
      <li><a href="http://notebook.dev/machines-valley-manuscript/">Machines in the Valley</a></li>
      <li><a href="http://notebook.dev/visualization-humanities/">Visualization in the Humanities</a></li>
      <li><a href="http://notebook.dev/open-research/">Open Research</a></li>
      <li><a href="http://notebook.dev/spatial-history/">Spatial History</a></li>

      <li class="nav-header">Meta</li>
      <li><a href="http://notebook.dev/project-news/">Notebook News</a></li>
      <li><a href="http://notebook.dev/about/">About Me</a></li>
      <li><a href="http://notebook.dev/notebook/">About This Notebook</a></li>
    </ul>
  </div>

</div> <!-- / span3 -->

        <div class="span9">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Calculate Borders Shared by Countries</h1>
    <p class="post-meta">Feb 3, 2016</p>
  </header>

  <article class="post-content">
    <p>Using R to find countries with shared borders. From <a href="https://gist.github.com/andrewheiss/926b9d60a26e29f6bf32">https://gist.github.com/andrewheiss/926b9d60a26e29f6bf32</a>. Copied here for reference.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Load libraries</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>

<span class="c1"># Map libraries</span>
<span class="kn">library</span><span class="p">(</span>rgdal<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>rgeos<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>spdep<span class="p">)</span>

<span class="c1"># Variables for getting map shapefiles</span>
map.url <span class="o">&lt;-</span> <span class="s">&quot;http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/50m/cultural/ne_50m_admin_0_countries.zip&quot;</span>
map.path <span class="o">&lt;-</span> <span class="kp">file.path</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;maps&quot;</span><span class="p">)</span>
map.zip.name <span class="o">&lt;-</span> <span class="kp">basename</span><span class="p">(</span>map.url<span class="p">)</span>
map.name <span class="o">&lt;-</span> tools<span class="o">::</span>file_path_sans_ext<span class="p">(</span>map.zip.name<span class="p">)</span>

<span class="c1"># Download Natural Earth shapefiles</span>
download.file<span class="p">(</span>url<span class="o">=</span>map.url<span class="p">,</span> <span class="kp">file.path</span><span class="p">(</span>map.path<span class="p">,</span> map.zip.name<span class="p">),</span> <span class="s">&quot;auto&quot;</span><span class="p">)</span>
unzip<span class="p">(</span><span class="kp">file.path</span><span class="p">(</span>map.path<span class="p">,</span> map.zip.name<span class="p">),</span> exdir<span class="o">=</span>map.path<span class="p">)</span>
<span class="kp">file.remove</span><span class="p">(</span><span class="kp">file.path</span><span class="p">(</span>map.path<span class="p">,</span> map.zip.name<span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] TRUE</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Load shapefiles</span>
countries <span class="o">&lt;-</span> readOGR<span class="p">(</span>map.path<span class="p">,</span> map.name<span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## OGR data source with driver: ESRI Shapefile 
## Source: &quot;Raw data/maps&quot;, layer: &quot;ne_50m_admin_0_countries&quot;
## with 241 features
## It has 63 fields</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Extract the ISO codes and map them to the numeric row names</span>
country.names <span class="o">&lt;-</span> <span class="kt">data_frame</span><span class="p">(</span>id <span class="o">=</span> <span class="kp">row.names</span><span class="p">(</span>countries<span class="o">@</span>data<span class="p">),</span>
                            country_iso3 <span class="o">=</span> <span class="kp">as.character</span><span class="p">(</span>countries<span class="o">@</span>data<span class="o">$</span>adm0_a3_is<span class="p">),</span>
                            neighbor_iso3 <span class="o">=</span> country_iso3<span class="p">)</span>

<span class="c1"># Determine which countries are neighbors</span>
neighbor.list <span class="o">&lt;-</span> poly2nb<span class="p">(</span>countries<span class="p">)</span>
neighbor.matrix <span class="o">&lt;-</span> nb2mat<span class="p">(</span>neighbor.list<span class="p">,</span> style<span class="o">=</span><span class="s">&quot;B&quot;</span><span class="p">,</span> zero.policy<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="kp">colnames</span><span class="p">(</span>neighbor.matrix<span class="p">)</span> <span class="o">&lt;-</span> <span class="kp">rownames</span><span class="p">(</span>neighbor.matrix<span class="p">)</span>

<span class="c1"># Clean up and transform the neighbor matrix</span>
all.neighbors <span class="o">&lt;-</span> <span class="kp">as.data.frame</span><span class="p">(</span>neighbor.matrix<span class="p">)</span> <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>country <span class="o">=</span> <span class="kp">row.names</span><span class="p">(</span><span class="m">.</span><span class="p">))</span> <span class="o">%&gt;%</span>  <span class="c1"># Convert row names to actual column</span>
  gather<span class="p">(</span>neighbor<span class="p">,</span> present<span class="p">,</span> <span class="o">-</span>country<span class="p">)</span> <span class="o">%&gt;%</span>  <span class="c1"># Convert to long</span>
  filter<span class="p">(</span>present <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>  <span class="c1"># Only look at cells with a match</span>
  <span class="c1"># Add country names</span>
  left_join<span class="p">(</span>select<span class="p">(</span>country.names<span class="p">,</span> <span class="o">-</span>neighbor_iso3<span class="p">),</span> by<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;country&quot;</span> <span class="o">=</span> <span class="s">&quot;id&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  left_join<span class="p">(</span>select<span class="p">(</span>country.names<span class="p">,</span> <span class="o">-</span>country_iso3<span class="p">),</span> by<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;neighbor&quot;</span> <span class="o">=</span> <span class="s">&quot;id&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  filter<span class="p">(</span>country_iso3 <span class="o">!=</span> <span class="s">&quot;-99&quot;</span><span class="p">,</span> neighbor_iso3 <span class="o">!=</span> <span class="s">&quot;-99&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>  <span class="c1"># Remove missing countries</span>
  select<span class="p">(</span>contains<span class="p">(</span><span class="s">&quot;iso3&quot;</span><span class="p">))</span>  <span class="c1"># Just get the ISO columns</span>
<span class="kp">head</span><span class="p">(</span>all.neighbors<span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##   country_iso3 neighbor_iso3
## 1          CHN           AFG
## 2          IRN           AFG
## 3          PAK           AFG
## 4          TJK           AFG
## 5          TKM           AFG
## 6          UZB           AFG</code></pre></figure>

<p>And summarize our findings:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r">neighbor.summary <span class="o">&lt;-</span> all.neighbors <span class="o">%&gt;%</span>
  group_by<span class="p">(</span>country_iso3<span class="p">)</span> <span class="o">%&gt;%</span>
  summarise<span class="p">(</span>num <span class="o">=</span> n<span class="p">())</span> <span class="o">%&gt;%</span>
  arrange<span class="p">(</span>desc<span class="p">(</span>num<span class="p">))</span>

neighbor.summary</code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Source: local data frame [160 x 2]
## 
##    country_iso3   num
##           (chr) (int)
## 1           CHN    16
## 2           RUS    14
## 3           SRB    12
## 4           BRA    10
## 5           FRA    10
## 6           COD     9
## 7           DEU     9
## 8           AUT     8
## 9           TUR     8
## 10          TZA     8
## ..          ...   ...</code></pre></figure>


  </article>

  <p class="text-info">
    <table class="table table-condensed" id="post-info">
      <tr class="info">
        <td><small><i class="glyphicon glyphicon-calendar"></i>&nbsp;Created: 03 Feb 2016</small></td>
        <td><small><i class="glyphicon glyphicon-calendar"></i>&nbsp;Modified: 03 Feb 2016</small></td>
        <td><small><i class="fa fa-github-square"></i>&nbsp;<a 
              href="https://github.com/hepplerj/notebook/commits/master/_posts/2016-02-03-calculate-borders-shared-by-countries.md">History</a></small></td>
        <td><small><a href="javascript:window.print()"><i class="glyphicon glyphicon-print"></i>&nbsp;Print</a></small></td>
        <td><small><a href="http://notebook.dev/calculate-borders-shared-by-countries/"><i class="glyphicon glyphicon-link"></i>Permalink</a></small></td>
      </tr>
    </table>
    </p>

<div class="tag-area alert-primary">
  <ul id="post-categories">
    <li><i class="glyphicon glyphicon-tags"></i>&nbsp;Tags: </li>
  
    <li class="categorylist"><a href='/tagged/#r'>R</a></li>
  
    <li class="categorylist"><a href='/tagged/#code'>code</a></li>
  
    <li class="categorylist"><a href='/tagged/#borders'>borders</a></li>
  
  </ul>
</div>

</div>

        </div>
      </div>
    </div>
    </div>

    <footer class="site-footer">

  <div class="footer-wrapper">

    <h2 class="footer-heading">Open History Notebook</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <figure class="image-left">
            <img class="avatar" src="http://notebook.dev/images/me.jpg" height="120" width="120"/>
          </figure>
          <p class="text">I am a historian at Stanford University. I'm affiliated with the <a href="http://cesta.stanford.org">Center for Spatial and Textual Analysis</a> and <a href="https://library.stanford.edu/research/center-interdisciplinary-digital-research-cidr">Center for Interidsciplinary Digital Research</a>.</p>

          <form method="get" action="http://duckduckgo.com/">
            <input type="search" name="q" maxlength="255" placeholder="Search">
            <input type="hidden" names="sites" value="notebook.jasonheppler.org">
            <input type="hidden" name="k7" value="#faf8f8">
            <input type="hidden" name="kj" value="#b33">
            <input type="hidden" name="ky" value="#fafafa">
            <input type="hidden" name="kx" value="b">
            <input type="hidden" name="ko" value="-1">
            <input type="hidden" name="k1" value="-1">
            <input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
          </form>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          <li>
            <i class="fa fa-globe"></i> <a href="http://jasonheppler.org">jasonheppler.org</a>
          </li>
          
          <li>
              <i class="fa fa-github-square"></i> <a href="https://github.com/hepplerj"><span class="username">hepplerj</span>
            </a>
          </li>
          

          
          <li>
              <i class="fa fa-twitter-square"></i> <a href="https://twitter.com/jaheppler"><span class="username">jaheppler</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        Jason Heppler<br/>
        <ul class="social-media-list">
          <li><i class="fa fa-university"></i> Department of History, Building 200, 450 Serra Mall, Stanford University</li>
          <li><i class="fa fa-envelope"></i> <a href="mailto:jason@jasonheppler.org">jason@jasonheppler.org</a></li>
        </ul>
      </div>
    </div>

  </div>

</footer>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12786552-3', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
